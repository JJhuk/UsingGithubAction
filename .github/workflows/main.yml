# This is a basic workflow to help you get started with Actions

name: CI

# Controls when the action will run. Triggers the workflow on push or pull request
# events but only for the master branch
on:
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]


jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2
    - name: Use Node.js LTS
      uses: actions/setup-node@v1
      with:
        node-version: '12'
    - run: npm install
    - run: npm install request

    - name: run helloweb.js
      id: hello
      run: node helloweb.js
      #continue-on-error: true

    - name: Check failure
      if: ${{ failure() }}
      run: |
        echo "HelloWorld" >> errorMessage.json
        crul -X POST -H "Authorization: Bearer 7AxVSvUUOsFki4Lo7y3wRpzYyUyJTnODpPr4973cLOr" -F message="Deployed spine static metadata${{fromJson(errorMessage.json)}}" https://notify-api.line.me/api/notify

    - name: reRun helloweb.js
      run: node helloweb.js

    - name: Check on failures
      run: echo Check success!!
    